<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveGeneric     #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass    #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE TemplateHaskell   #-}</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-comment">-- | Fields for persistent data structures in 'Core.Model'.</span><span>
</span><a name="line-7"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Fields</span><span> </span><span>
</span><a name="line-8"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="Core.Fields.html#Privilege"><span class="hs-identifier hs-type">Privilege</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-9"></a><span>    </span><span class="hs-comment">-- * Forums</span><span>
</span><a name="line-10"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Core.Fields.html#ForumCategory"><span class="hs-identifier hs-type">ForumCategory</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-11"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Core.Fields.html#ForumBoard"><span class="hs-identifier hs-type">ForumBoard</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Core.Fields.html#getBoards"><span class="hs-identifier hs-var">getBoards</span></a><span>
</span><a name="line-13"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Core.Fields.html#boardName"><span class="hs-identifier hs-var">boardName</span></a><span class="hs-special">,</span><span> </span><a href="Core.Fields.html#boardDesc"><span class="hs-identifier hs-var">boardDesc</span></a><span>
</span><a name="line-14"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><a href="Preludesque.html"><span class="hs-identifier">Preludesque</span></a><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Generics</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ClassyPrelude</span><span class="hs-operator">.</span><span class="hs-identifier">Yesod</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">PathPiece</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">derivePersistField</span><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Aeson</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">pack</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">unpack</span><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Read</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="Calculus.html"><span class="hs-identifier">Calculus</span></a><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">data</span><span> </span><a name="Privilege"><a href="Core.Fields.html#Privilege"><span class="hs-identifier">Privilege</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Normal"><a href="Core.Fields.html#Normal"><span class="hs-identifier">Normal</span></a></a><span> </span><span>
</span><a name="line-27"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="Moderator"><a href="Core.Fields.html#Moderator"><span class="hs-identifier">Moderator</span></a></a><span> </span><span>
</span><a name="line-28"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="Admin"><a href="Core.Fields.html#Admin"><span class="hs-identifier">Admin</span></a></a><span> </span><span>
</span><a name="line-29"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bounded</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span class="hs-identifier hs-var">derivePersistField</span><span> </span><span class="hs-string">&quot;Privilege&quot;</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-keyword">data</span><span> </span><a name="ForumCategory"><a href="Core.Fields.html#ForumCategory"><span class="hs-identifier">ForumCategory</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Official"><a href="Core.Fields.html#Official"><span class="hs-identifier">Official</span></a></a><span>
</span><a name="line-33"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="Community"><a href="Core.Fields.html#Community"><span class="hs-identifier">Community</span></a></a><span>
</span><a name="line-34"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="Feedback"><a href="Core.Fields.html#Feedback"><span class="hs-identifier">Feedback</span></a></a><span>
</span><a name="line-35"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="General"><a href="Core.Fields.html#General"><span class="hs-identifier">General</span></a></a><span>
</span><a name="line-36"></a><span>                   </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bounded</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span>                   </span><span>
</span><a name="line-38"></a><span>                </span><span class="hs-comment">-- Official</span><span>
</span><a name="line-39"></a><span class="hs-keyword">data</span><span> </span><a name="ForumBoard"><a href="Core.Fields.html#ForumBoard"><span class="hs-identifier">ForumBoard</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="NewsAndAnnouncements"><a href="Core.Fields.html#NewsAndAnnouncements"><span class="hs-identifier">NewsAndAnnouncements</span></a></a><span>
</span><a name="line-40"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="ForumInfo"><a href="Core.Fields.html#ForumInfo"><span class="hs-identifier">ForumInfo</span></a></a><span>
</span><a name="line-41"></a><span>                </span><span class="hs-comment">-- Community</span><span>
</span><a name="line-42"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="IntroduceYourself"><a href="Core.Fields.html#IntroduceYourself"><span class="hs-identifier">IntroduceYourself</span></a></a><span>
</span><a name="line-43"></a><span>                </span><span class="hs-comment">-- Feedback</span><span>
</span><a name="line-44"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="BugReports"><a href="Core.Fields.html#BugReports"><span class="hs-identifier">BugReports</span></a></a><span>       </span><span>
</span><a name="line-45"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="TechnicalSupport"><a href="Core.Fields.html#TechnicalSupport"><span class="hs-identifier">TechnicalSupport</span></a></a><span> </span><span>
</span><a name="line-46"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="Suggestions"><a href="Core.Fields.html#Suggestions"><span class="hs-identifier">Suggestions</span></a></a><span>
</span><a name="line-47"></a><span>                </span><span class="hs-comment">-- General</span><span>
</span><a name="line-48"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="OffTopic"><a href="Core.Fields.html#OffTopic"><span class="hs-identifier">OffTopic</span></a></a><span>
</span><a name="line-49"></a><span>                </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bounded</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span class="hs-identifier hs-var">derivePersistField</span><span> </span><span class="hs-string">&quot;ForumBoard&quot;</span><span>
</span><a name="line-51"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">PathPiece</span><span> </span><a href="Core.Fields.html#ForumBoard"><span class="hs-identifier hs-type">ForumBoard</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-52"></a><span>  </span><a name="local-8214565720323800063"><span class="hs-identifier">toPathPiece</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pack</span><span> </span><span class="">&#8728;</span><span> </span><span class="hs-identifier hs-var">show</span><span>
</span><a name="line-53"></a><span>  </span><a name="local-8214565720323800064"><span class="hs-identifier">fromPathPiece</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">readMaybe</span><span> </span><span class="">&#8728;</span><span> </span><span class="hs-identifier hs-var">unpack</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span class="hs-identifier">category</span><span> </span><span class="">&#8759;</span><span> </span><a href="Core.Fields.html#ForumBoard"><span class="hs-identifier hs-type">ForumBoard</span></a><span> </span><span class="">&#8594;</span><span> </span><a href="Core.Fields.html#ForumCategory"><span class="hs-identifier hs-type">ForumCategory</span></a><span>
</span><a name="line-56"></a><a name="category"><a href="Core.Fields.html#category"><span class="hs-identifier">category</span></a></a><span> </span><a href="Core.Fields.html#NewsAndAnnouncements"><span class="hs-identifier hs-var">NewsAndAnnouncements</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Core.Fields.html#Official"><span class="hs-identifier hs-var">Official</span></a><span>
</span><a name="line-57"></a><span class="hs-identifier">category</span><span> </span><a href="Core.Fields.html#ForumInfo"><span class="hs-identifier hs-var">ForumInfo</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="Core.Fields.html#Official"><span class="hs-identifier hs-var">Official</span></a><span>
</span><a name="line-58"></a><span class="hs-identifier">category</span><span> </span><a href="Core.Fields.html#IntroduceYourself"><span class="hs-identifier hs-var">IntroduceYourself</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Core.Fields.html#Community"><span class="hs-identifier hs-var">Community</span></a><span>
</span><a name="line-59"></a><span class="hs-identifier">category</span><span> </span><a href="Core.Fields.html#BugReports"><span class="hs-identifier hs-var">BugReports</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Core.Fields.html#Feedback"><span class="hs-identifier hs-var">Feedback</span></a><span>
</span><a name="line-60"></a><span class="hs-identifier">category</span><span> </span><a href="Core.Fields.html#TechnicalSupport"><span class="hs-identifier hs-var">TechnicalSupport</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Core.Fields.html#Feedback"><span class="hs-identifier hs-var">Feedback</span></a><span>
</span><a name="line-61"></a><span class="hs-identifier">category</span><span> </span><a href="Core.Fields.html#Suggestions"><span class="hs-identifier hs-var">Suggestions</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Core.Fields.html#Feedback"><span class="hs-identifier hs-var">Feedback</span></a><span>
</span><a name="line-62"></a><span class="hs-identifier">category</span><span> </span><a href="Core.Fields.html#OffTopic"><span class="hs-identifier hs-var">OffTopic</span></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Core.Fields.html#General"><span class="hs-identifier hs-var">General</span></a><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-identifier">boardName</span><span> </span><span class="">&#8759;</span><span> </span><a href="Core.Fields.html#ForumBoard"><span class="hs-identifier hs-type">ForumBoard</span></a><span> </span><span class="">&#8594;</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-65"></a><a name="boardName"><a href="Core.Fields.html#boardName"><span class="hs-identifier">boardName</span></a></a><span> </span><a href="Core.Fields.html#NewsAndAnnouncements"><span class="hs-identifier hs-var">NewsAndAnnouncements</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;News and Announcements&quot;</span><span>
</span><a name="line-66"></a><span class="hs-identifier">boardName</span><span> </span><a href="Core.Fields.html#ForumInfo"><span class="hs-identifier hs-var">ForumInfo</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Forum Info&quot;</span><span>
</span><a name="line-67"></a><span class="hs-identifier">boardName</span><span> </span><a href="Core.Fields.html#IntroduceYourself"><span class="hs-identifier hs-var">IntroduceYourself</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Introduce Yourself&quot;</span><span>
</span><a name="line-68"></a><span class="hs-identifier">boardName</span><span> </span><a href="Core.Fields.html#BugReports"><span class="hs-identifier hs-var">BugReports</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Bug Reports&quot;</span><span>
</span><a name="line-69"></a><span class="hs-identifier">boardName</span><span> </span><a href="Core.Fields.html#TechnicalSupport"><span class="hs-identifier hs-var">TechnicalSupport</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Technical Support&quot;</span><span>
</span><a name="line-70"></a><span class="hs-identifier">boardName</span><span> </span><a href="Core.Fields.html#OffTopic"><span class="hs-identifier hs-var">OffTopic</span></a><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Off Topic&quot;</span><span>
</span><a name="line-71"></a><span class="hs-identifier">boardName</span><span> </span><a name="local-6989586621679204348"><a href="#local-6989586621679204348"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679204348"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-identifier">boardDesc</span><span> </span><span class="">&#8759;</span><span> </span><a href="Core.Fields.html#ForumBoard"><span class="hs-identifier hs-type">ForumBoard</span></a><span> </span><span class="">&#8594;</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-74"></a><a name="boardDesc"><a href="Core.Fields.html#boardDesc"><span class="hs-identifier">boardDesc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Sample description for &quot;</span><span> </span><span class="">&#10746;</span><span class="hs-special">)</span><span> </span><span class="">&#8728;</span><span> </span><span class="hs-special">(</span><span class="">&#10746;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span class="hs-special">)</span><span> </span><span class="">&#8728;</span><span> </span><a href="Core.Fields.html#boardName"><span class="hs-identifier hs-var">boardName</span></a><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-identifier">getBoards</span><span> </span><span class="">&#8759;</span><span> </span><a href="Core.Fields.html#ForumCategory"><span class="hs-identifier hs-type">ForumCategory</span></a><span> </span><span class="">&#8594;</span><span> </span><span class="hs-special">[</span><a href="Core.Fields.html#ForumBoard"><span class="hs-identifier hs-type">ForumBoard</span></a><span class="hs-special">]</span><span>
</span><a name="line-77"></a><a name="getBoards"><a href="Core.Fields.html#getBoards"><span class="hs-identifier">getBoards</span></a></a><span> </span><a name="local-6989586621679204349"><a href="#local-6989586621679204349"><span class="hs-identifier">cat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679204349"><span class="hs-identifier hs-var">cat</span></a><span> </span><span class="">&#8801;</span><span class="hs-special">)</span><span> </span><span class="">&#8728;</span><span> </span><a href="Core.Fields.html#category"><span class="hs-identifier hs-var">category</span></a><span class="hs-special">)</span><span> </span><a href="Calculus.html#enums"><span class="hs-identifier hs-var">enums</span></a><span>
</span><a name="line-78"></a></pre></body></html>